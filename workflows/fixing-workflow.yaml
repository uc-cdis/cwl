#!/usr/bin/env cwl-runner

cwlVersion: v1.0

class: Workflow

inputs:

  - id: input_bam_path
    type: File
  - id: reference_seq
    type: File

outputs:

  - id: paired_output_file
    type: File
    outputSource: remove-unpaired/paired_output_bam
  - id: nophix_output_file
    type: File
    outputSource: remove-phix/fixed_output_bam

steps:

  - id: remove-unpaired
    run: ../tools/sorting/RemoveUnpaired.cwl.yaml
    in:
       - id: input_bam_path
         source: input_bam_path

    out:
       - id: paired_output_bam

  - id: remove-phix
    run: ../tools/sorting/RemovePhiX.cwl.yaml
    in:
       - id: input_bam_path
         source: remove-unpaired/paired_output_bam

    out:
       - id: fixed_output_bam
